<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>席替えくん26</title>
    <style>
        body { font-family: sans-serif; background-color: #2b3a42; color: #fff; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; -webkit-tap-highlight-color: transparent; }
        header { background: #fff; color: #333; width: 100%; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        .blackboard { width: 80%; height: 40px; background: #1a472a; border: 4px solid #5d4037; border-radius: 4px; margin: 20px 0; display: flex; align-items: center; justify-content: center; font-size: 12px; letter-spacing: 10px; color: rgba(255,255,255,0.2); font-weight: bold; }
        .grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; width: 95%; max-width: 1000px; padding-bottom: 120px; }
        .seat { aspect-ratio: 4/3; perspective: 1000px; cursor: pointer; }
        .card { position: relative; width: 100%; height: 100%; transition: transform 0.5s; transform-style: preserve-3d; }
        .card.flipped { transform: rotateY(180deg); }
        .face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 6px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .front { background: #f0e6d2; color: #8d6e63; border: 1px dashed rgba(141,110,99,0.3); }
        .back { transform: rotateY(180deg); background: #fff; color: #333; }
        .back.boy { background: #dbeafe; } /* 男子：青 */
        .back.girl { background: #fce7f3; } /* 女子：ピンク */
        .s-name { font-size: 16px; font-weight: bold; }
        .s-num { font-size: 10px; color: #666; margin-bottom: 2px; }
        .footer { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.8); padding: 15px; display: flex; justify-content: center; gap: 10px; backdrop-blur: 5px; z-index: 100; }
        button { padding: 12px 24px; border-radius: 30px; border: none; font-weight: bold; cursor: pointer; font-size: 14px; }
        .btn-shuffle { background: #4f46e5; color: #fff; }
        .btn-reveal { background: #16a34a; color: #fff; }
        .btn-mode { background: #eee; color: #333; font-size: 12px; padding: 5px 10px; }
    </style>
</head>
<body>

<header>
    <div style="font-weight: bold;">座席替えツール</div>
    <button class="btn-mode" onclick="toggleMode()" id="modeBtn">教員モードへ</button>
</header>

<div id="teacherArea" style="display:none; background:#fff; color:#333; width:90%; max-width:600px; padding:15px; border-radius:8px; margin-top:10px;">
    <p style="font-size:12px; margin:0 0 10px 0;">名簿 (番号, 名前, 性別) ※性別に「女」を入れるとピンクになります</p>
    <textarea id="listInput" style="width:100%; height:120px; font-size:12px;">1, 佐藤 健, 男
2, 鈴木 愛, 女
3, 高橋 翔, 男
4, 田中 美咲, 女
5, 伊藤 翼, 男
6, 渡辺 結衣, 女
7, 山本 蓮, 男
8, 中村 陽菜, 女</textarea>
    <button onclick="applyList()" style="width:100%; margin-top:10px; background:#4f46e5; color:#fff;">名簿を更新して配置</button>
</div>

<div class="blackboard">BLACKBOARD</div>
<div id="grid" class="grid"></div>

<div class="footer">
    <button class="btn-shuffle" onclick="shuffle()">シャッフル</button>
    <button class="btn-reveal" onclick="revealAll()">一斉公開</button>
    <button onclick="resetCards()" style="background:#666; color:#fff; border-radius:30px; border:none; padding:10px 15px;">伏せる</button>
</div>

<script>
    let studentData = [];
    let currentSeats = [];

    // 音声の代わり：ブラウザのビープ音的な演出
    const playEffect = (freq, dur) => {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain); gain.connect(ctx.destination);
        osc.frequency.value = freq;
        gain.gain.setValueAtTime(0.1, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + dur);
        osc.start(); osc.stop(ctx.currentTime + dur);
    };

    function toggleMode() {
        const area = document.getElementById('teacherArea');
        const btn = document.getElementById('modeBtn');
        if (area.style.display === 'none') {
            area.style.display = 'block';
            btn.innerText = '設定を閉じる';
        } else {
            area.style.display = 'none';
            btn.innerText = '教員モードへ';
        }
    }

    function applyList() {
        const text = document.getElementById('listInput').value;
        studentData = text.trim().split('\n').map((line, i) => {
            const p = line.split(/[,\t]/).map(s => s.trim());
            return { num: p[0], name: p[1] || `生徒${i+1}`, gender: p[2] === '女' ? 'girl' : 'boy' };
        });
        currentSeats = [...studentData];
        render();
    }

    function shuffle() {
        playEffect(440, 0.1);
        let count = 0;
        const timer = setInterval(() => {
            currentSeats.sort(() => Math.random() - 0.5);
            render(true);
            count++;
            if (count > 12) {
                clearInterval(timer);
                playEffect(880, 0.5);
                render(false);
            }
        }, 100);
    }

    function render(isShuffling = false) {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        currentSeats.forEach((s, i) => {
            const seat = document.createElement('div');
            seat.className = 'seat';
            seat.innerHTML = `
                <div class="card ${isShuffling ? '' : ''}" id="card-${i}">
                    <div class="face front"><span style="opacity:0.2; font-size:24px;">${s.num}</span></div>
                    <div class="face back ${s.gender}">
                        <div class="s-num">${s.num}</div>
                        <div class="s-name">${s.name}</div>
                    </div>
                </div>
            `;
            seat.onclick = () => {
                playEffect(660, 0.1);
                document.getElementById(`card-${i}`).classList.toggle('flipped');
            };
            grid.appendChild(seat);
        });
    }

    function revealAll() {
        playEffect(1200, 0.6);
        document.querySelectorAll('.card').forEach(c => c.classList.add('flipped'));
    }

    function resetCards() {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('flipped'));
    }

    // 起動
    applyList();
</script>
</body>
</html>
